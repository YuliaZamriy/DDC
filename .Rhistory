select(OrgProjectStartMonth, OrgProjectDur) %>%
mutate(OrgProjectStartMonth = as.numeric(OrgProjectStartMonth))
FullData %>%
filter(DivisionName == "Infrastructure") %>%
select(OrgProjectStartMonth, OrgProjectDur) %>%
mutate(OrgProjectStartMonth = as.numeric(OrgProjectStartMonth)) %>%
cor()
cor(as.numeric(FullData$OrgProjectStartMonth), FullData$OrgProjectDur)
FullData %>%
filter(DivisionName == "Public Buildings") %>%
select(OrgProjectStartMonth, OrgProjectDur) %>%
mutate(OrgProjectStartMonth = as.numeric(OrgProjectStartMonth)) %>%
cor()
Sponsor <-
FullData %>%
group_by(Sponsor) %>%
summarize(AvgProjDur = mean(OrgProjectDur),
n = n())
ggplot(Sponsor, aes(x = reorder(Sponsor, -AvgProjDur), y = AvgProjDur)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 90, size = 7),
axis.title.y = element_text(size = 7),
plot.title = element_text(size = 10, hjust = 0.5)) +
xlab("Sponsor") +
ylab("Original Average Project Duration (in days)") +
ggtitle("Average Project Duration by Sponsor")
ggplot(ProjectType, aes(x = reorder(ProjectType, -AvgProjDur), y = AvgProjDur)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 90, size = 7),
axis.title.y = element_text(size = 7),
plot.title = element_text(size = 10, hjust = 0.5)) +
xlab("Project Type") +
ylab("Original Average Project Duration (in days)") +
ggtitle("Average Project Duration by Project Type")
ggplot(DesignType, aes(x = reorder(DesignContractType, -AvgProjDur), y = AvgProjDur)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 90, size = 7),
axis.title.y = element_text(size = 7),
plot.title = element_text(size = 10, hjust = 0.5)) +
xlab("Design Contract Type") +
ylab("Original Average Project Duration (in days)") +
ggtitle("Average Project Duration by Design Contract Type")
FullData %>%
group_by(DesignContractType) %>%
summarize(AvgProjDur = mean(OrgProjectDur),
n = n()) %>%
arrange(desc(AvgProjDur))
DurCor <- cor(FullData[,  c("OrgProjectDur", "OrgInitiationDurPct", "OrgDesignDurPct", "OrgConstructionDurPct", "OrgCloseoutDurPct")],
use = "pairwise")
DurCor
cor(FullData[,  c("OrgInitiationDur", "OrgDesignDur", "OrgConstructionDur", "OrgCloseoutDur")],
use = "pairwise")
cor(FullData[,  c("OrgProjectDur", "OrgInitiationDurPct", "OrgDesignDurPct", "OrgConstructionDurPct", "OrgCloseoutDurPct")],
use = "pairwise")[-1, 1]
round(cor(FullData[,  c("OrgProjectDur", "OrgInitiationDurPct", "OrgDesignDurPct", "OrgConstructionDurPct", "OrgCloseoutDurPct")],
use = "pairwise")[-1, 1], 2)
?cor
round(cor(FullData[,  c("OrgInitiationDur", "OrgDesignDur", "OrgConstructionDur", "OrgCloseoutDur")],
use = "pairwise"))
round(cor(FullData[,  c("OrgInitiationDur", "OrgDesignDur", "OrgConstructionDur", "OrgCloseoutDur")],
use = "pairwise"),2)
ggplot(FullData, aes(OrgProjectDur, OrgInitiationDurPct)) +
geom_line()
ggplot(FullData, aes(OrgProjectDur, OrgInitiationDurPct)) +
geom_point()
ggplot(FullData, aes(OrgProjectDur, OrgInitiationDurPct)) +
geom_point() +
facet_wrap(~DivisionName)
ggplot(FullData, aes(OrgProjectDur, log(OrgInitiationDurPct))) +
geom_point() +
facet_wrap(~DivisionName)
ggplot(FullData, aes(log(OrgProjectDur), OrgInitiationDurPct)) +
geom_point() +
facet_wrap(~DivisionName)
ggplot(FullData, aes(log(OrgProjectDur), log(OrgInitiationDurPct))) +
geom_point() +
facet_wrap(~DivisionName)
ggplot(FullData, aes(OrgInitiationDurPct, OrgProjectDur)) +
geom_point() +
facet_wrap(~DivisionName)
ggplot(FullData[DivisionName == "Infrastructure"], aes(OrgInitiationDurPct, OrgProjectDur)) +
geom_point() +
facet_wrap(~ProjectType)
ggplot(FullData[FullData$DivisionName == "Infrastructure"],
aes(OrgInitiationDurPct, OrgProjectDur)) +
geom_point() +
facet_wrap(~ProjectType)
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur)) +
geom_point() +
facet_wrap(~ProjectType)
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = "ProjectType")) +
geom_point()
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = ProjectType)) +
geom_point()
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point()
ggplot(FullData[FullData$DivisionName == "Infrastructure" & FullData$ProjectType == "Street Reconstruction",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point()
ggplot(FullData[FullData$DivisionName == "Infrastructure" & FullData$ProjectType == "Street Reconstruction",],
aes(OrgInitiationDurPct, OrgProjectDur , color = UnitName)) +
geom_point()
ggplot(FullData[FullData$DivisionName == "Infrastructure" & FullData$ProjectType == "Street Reconstruction",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Sponsor)) +
geom_point()
ggplot(FullData[FullData$DivisionName == "Infrastructure" & FullData$ProjectType == "Street Reconstruction",],
aes(OrgInitiationDurPct, OrgProjectDur , color = DesignContractType)) +
geom_point()
ggplot(FullData[FullData$DivisionName == "Infrastructure" & FullData$ProjectType == "Street Reconstruction",],
aes(OrgInitiationDurPct, OrgProjectDur , color = ConstructionContractType)) +
geom_point()
ggplot(FullData[FullData$DivisionName == "Infrastructure" & FullData$ProjectType == "Street Reconstruction",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Priority)) +
geom_point()
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = ProjectType)) +
geom_point()
ggplot(FullData[FullData$DivisionName == "Public Buildings",],
aes(OrgInitiationDurPct, OrgProjectDur , color = ProjectType)) +
geom_point()
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = ProjectType)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration")
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration")
ggplot(FullData[FullData$DivisionName == "Public Buildings",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration")
infra <-
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
ylab("Average Project Duration") +
theme(axis.title.x = element_blank())
pub <-
ggplot(FullData[FullData$DivisionName == "Public Buildings",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration")
grid.arrange(infra, pub)
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
ylab("Average Project Duration") +
theme(axis.title.x = element_blank(),
legend.text = element_blank())
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
ylab("Average Project Duration") +
guides(fill = FALSE) +
theme(axis.title.x = element_blank())
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
ylab("Average Project Duration") +
theme(axis.title.x = element_blank(),
legend.position = "none")
infra <-
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
ylab("Average Project Duration") +
theme(axis.title.x = element_blank(),
legend.position = "none")
pub <-
ggplot(FullData[FullData$DivisionName == "Public Buildings",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration")
grid.arrange(infra, pub)
ggplot(FullData[FullData$DivisionName == "Public Buildings",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration") +
theme(legend.title = element_blank())
infra <-
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
ylab("Average Project Duration") +
theme(axis.title.x = element_blank(),
legend.position = "none")
pub <-
ggplot(FullData[FullData$DivisionName == "Public Buildings",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration") +
theme(legend.title = element_blank(),
legend.position = "bottom")
grid.arrange(infra, pub)
infra <-
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
ylab("Average Project Duration") +
theme(legend.title = element_blank(),
legend.position = "bottom")
pub <-
ggplot(FullData[FullData$DivisionName == "Public Buildings",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration")
grid.arrange(infra, pub)
infra <-
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
ylab("Average Project Duration") +
theme(axis.title.x = element_blank(),
legend.title = element_blank(),
legend.position = "bottom")
pub <-
ggplot(FullData[FullData$DivisionName == "Public Buildings",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration")
grid.arrange(infra, pub)
infra <-
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
ylab("Average Project Duration") +
theme(axis.title.x = element_blank(),
legend.title = element_blank(),
legend.position = "bottom")
pub <-
ggplot(FullData[FullData$DivisionName == "Public Buildings",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration") +
theme(axis.title.x = element_text(size = 8),
legend.position = "none")
grid.arrange(infra, pub)
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
ylab("Average Project Duration") +
theme(axis.title.x = element_blank(),
legend.title = element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 6))
pub <-
ggplot(FullData[FullData$DivisionName == "Public Buildings",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration") +
theme(axis.title.x = element_text(size = 8),
legend.position = "none")
grid.arrange(infra, pub)
infra <-
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
ylab("Average Project Duration") +
theme(axis.title.x = element_blank(),
legend.title = element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 6))
pub <-
ggplot(FullData[FullData$DivisionName == "Public Buildings",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration") +
theme(axis.title.x = element_text(size = 8),
legend.position = "none")
grid.arrange(infra, pub)
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
ylab("Average Project Duration") +
theme(axis.title.x = element_blank(),
legend.title = element_blank(),
legend.position = "bottom",
legend.text = element_text(size = 6))
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
ylab("Average Project Duration") +
theme(axis.title.x = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 6))
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
ylab("Average Project Duration") +
theme(axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.title = element_blank(),
legend.text = element_text(size = 8))
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration") +
ggtile("Infrastructure Projects Overal Duration vs. Initiation Stage")
theme(axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.title = element_blank(),
legend.text = element_text(size = 8))
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration") +
ggtile("Infrastructure Projects Overal Duration vs. Initiation Stage") +
theme(axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.title = element_blank(),
legend.text = element_text(size = 8))
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration") +
ggtitle("Infrastructure Projects Overal Duration vs. Initiation Stage") +
theme(axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.title = element_blank(),
legend.text = element_text(size = 8))
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration") +
ggtitle("Infrastructure Projects Overal Duration vs. Initiation Stage") +
theme(axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.title = element_blank(),
legend.text = element_text(size = 8),
plot.title = element_text(size = 10))
ggplot(FullData[FullData$DivisionName == "Public Buildings",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration") +
ggtitle("Public Building Projects Overal Duration vs. Initiation Stage") +
theme(axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.title = element_blank(),
legend.text = element_text(size = 8),
plot.title = element_text(size = 10))
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)
library(tidyverse)
library(gridExtra)
FullData <- load("DDCChallenegeAnalysisData.RData")
nrow(FullData)
summary(FullData$OrgProjectDur)
library(tidyverse)
library(gridExtra)
FullData <- load("DDCChallenegeAnalysisData.RData")
nrow(FullData)
summary(FullData$OrgProjectDur)
library(tidyverse)
library(gridExtra)
FullData <- load("FullData.Rdata")
nrow(FullData)
summary(FullData$OrgProjectDur)
library(tidyverse)
library(gridExtra)
load("FullData.Rdata")
nrow(FullData)
summary(FullData$OrgProjectDur)
library(tidyverse)
library(gridExtra)
load("DDCChallenegeAnalysisData.RData")
nrow(FullData)
summary(FullData$OrgProjectDur)
hist(FullData$OrgProjectDur,
breaks = seq(0, 12000, 500) - 250,
main = "Histogram for Original Project Duration (in Days)",
xlab = NULL,
cex.main = 1,
xaxt = "n",
yaxt = "n",
col = "lightgrey")
axis(side=1,
at=seq(0, 12000, 1000),
labels=seq(0, 12000, 1000),
cex.axis = 0.5)
axis(side=2,
at=seq(0, 200, 50),
labels=seq(0, 200, 50),
cex.axis = 0.6)
FullData %>%
group_by(DivisionName) %>%
summarize(AvgProjDur = mean(OrgProjectDur),
n = n()) %>%
arrange(desc(AvgProjDur))
FullData %>%
group_by(Borough) %>%
summarize(AvgProjDur = mean(OrgProjectDur),
n = n()) %>%
arrange(desc(AvgProjDur))
FullData %>%
group_by(Sponsor) %>%
summarize(AvgProjDur = mean(OrgProjectDur),
n = n()) %>%
arrange(desc(AvgProjDur))
FullData %>%
group_by(ProjectType) %>%
summarize(AvgProjDur = mean(OrgProjectDur),
n = n()) %>%
arrange(desc(AvgProjDur))
FullData %>%
group_by(DesignContractType) %>%
summarize(AvgProjDur = mean(OrgProjectDur),
n = n()) %>%
arrange(desc(AvgProjDur))
FullData %>%
group_by(ConstructionContractType) %>%
summarize(AvgProjDur = mean(OrgProjectDur),
n = n()) %>%
arrange(desc(AvgProjDur))
FullData %>%
filter(DivisionName == "Infrastructure") %>%
group_by(ProjectType) %>%
summarize(AvgProjDur = mean(OrgProjectDur),
n = n()) %>%
arrange(desc(AvgProjDur))
FullData %>%
filter(DivisionName == "Infrastructure") %>%
group_by(Borough) %>%
summarize(AvgProjDur = mean(OrgProjectDur),
n = n()) %>%
arrange(desc(AvgProjDur))
ProjectTypes = c("Street Reconstruction", "Water", "Other", "Ped Ramps", "Sidewalks")
ByBorough <- FullData %>%
filter(DivisionName == "Infrastructure" &
ProjectType %in% ProjectTypes) %>%
group_by(Borough, ProjectType) %>%
summarize(AvgProjDur = mean(OrgProjectDur))
ggplot(ByBorough, aes(Borough, AvgProjDur, fill = Borough)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ProjectType) +
scale_fill_brewer(palette="Accent") +
ylab("Original Average Project Duration") +
ggtitle("Average Duration (in Days) for Selected Infrastructure Projects by Borough") +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 8),
axis.text.y = element_text(size = 6),
plot.title = element_text(size = 10))
ProjectStartMonthDivName <-
FullData %>%
group_by(OrgProjectStartMonth, DivisionName) %>%
summarize(AvgProjDur = mean(OrgProjectDur),
n = n())
avedur <-
ggplot(ProjectStartMonthDivName,
aes(OrgProjectStartMonth,
AvgProjDur)) +
geom_bar(stat = "identity", fill = "darkblue") +
xlab("Original Project Start Month") +
ylab("Average Project Duration (in days)") +
facet_grid(.~DivisionName) +
theme(axis.title.x = element_text(size = 7),
axis.title.y = element_text(size = 7))
numproj <-
ggplot(ProjectStartMonthDivName, aes(OrgProjectStartMonth, n)) +
geom_bar(stat = "identity", fill = "darkgreen") +
xlab("Original Project Start Month") +
ylab("Number of Projects") +
facet_grid(.~DivisionName) +
theme(axis.title.x = element_text(size = 7),
axis.title.y = element_text(size = 7))
grid.arrange(avedur, numproj)
round(cor(FullData[,  c("OrgProjectDur", "OrgInitiationDurPct", "OrgDesignDurPct", "OrgConstructionDurPct", "OrgCloseoutDurPct")],
use = "pairwise")[-1, 1], 2)
ggplot(FullData[FullData$DivisionName == "Infrastructure",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration") +
ggtitle("Infrastructure Projects Overal Duration vs. Initiation Stage") +
theme(axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.title = element_blank(),
legend.text = element_text(size = 8),
plot.title = element_text(size = 10))
ggplot(FullData[FullData$DivisionName == "Public Buildings",],
aes(OrgInitiationDurPct, OrgProjectDur , color = Borough)) +
geom_point() +
xlab("Share of Initiation Stage in Total Duration") +
ylab("Average Project Duration") +
ggtitle("Public Building Projects Overal Duration vs. Initiation Stage") +
theme(axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.title = element_blank(),
legend.text = element_text(size = 8),
plot.title = element_text(size = 10))
